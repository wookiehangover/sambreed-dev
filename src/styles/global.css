@import "theme.css";

@layer reset, base, components, layout, utilities;

@layer reset {
	* {
		box-sizing: border-box;
	}

	html {
		scroll-behavior: smooth;
	}

	body {
		margin: 0;
		height: 100dvh;
	}
}

@layer base {
	body {
		color-scheme: light dark;
		color: var(--text-color);
		background-color: var(--background-color);
		font-family: var(--font-family-body);
		/* letter-spacing: 0.4Q; */
		-webkit-font-smoothing: antialiased;
		text-rendering: optimizeLegibility;
		hyphens: auto;
		word-wrap: break-word;
		overflow-wrap: break-word;
		line-height: 1.6;
	}

	h1,
	h2,
	h3,
	h4,
	h5,
	h6 {
		text-wrap: balance;
		font-family: var(--font-family-heading);
		font-weight: 600;
		color: var(--bold-color);
	}

	strong,
	b {
		font-weight: 600;
		letter-spacing: 0.03em;
		color: var(--bold-color);
	}

	a {
		color: var(--link-color);
		text-decoration: none;
	}

	a:hover {
		color: var(--link-color-hover);
		text-decoration: underline;
		/* text-underline-offset: 4px; */
		text-underline-offset: 0.25lh;
	}

	p {
		text-wrap: pretty;
	}

	textarea {
		width: 100%;
		font-size: 16px;
	}

	input {
		font-size: 16px;
	}

	img {
		max-width: 100%;
		height: auto;
	}

	table {
		width: 100%;
		width: fit-content;
		border-spacing: 0;
		border-collapse: collapse;
	}

	table td,
	table th {
		border: 1px solid var(--hr-border-color);
		padding: 0.25rem 0.5rem;
	}

	table th {
		font-size: 0.875rem;
	}

	code {
		padding: 2px 5px;
		background-color: var(--code-background-color);
	}

	pre {
		padding: 1rem;
		border-radius: 0.25rem;
		max-width: 100%;
		tab-size: 2;
	}

	pre > code {
		all: unset;
		white-space: pre-wrap;
	}

	blockquote {
		border-left: 2px solid var(--blockquote-border-color);
		color: var(--blockquote-color);
		padding-left: 23px;
		margin-inline-start: 0;
		margin-inline-end: 1.5rem;
		line-height: 1.4;
		font-size: 1.125rem;
	}

	hr {
		border-top: 1px solid var(--hr-border-color);
		border-color: var(--hr-border-color);
		margin: 1rem 0;
	}

	figure {
		width: 100%;
		margin-left: 0;
	}

	figure img {
		display: block;
		margin: 1rem auto;
		border-radius: 0.25rem;
	}

	figure video {
		max-width: 100%;
		border-radius: 0.25rem;
	}

	figcaption {
		color: var(--text-dim);
		font-size: 0.75em;
	}
}

@layer components {
	/* Content-specific styling */
	section a {
		text-decoration: underline;
		text-underline-offset: 2px;
		transition: all 0.1s;
	}

	article > p {
		margin-block: 1lh;
		&:first-of-type {
			margin-block-start: unset;
		}
	}

	article ol,
	article ul {
		padding-inline-start: 1rem;
		padding-inline-end: 1rem;
	}

	article ol > li {
		/* margin-bottom: 0.75rem; */
		margin-bottom: 0.5lh;
		padding-left: 0.5rem;
		max-width: 80%;
		text-wrap: pretty;
	}

	article ul > li {
		/* margin-bottom: 0.25rem; */
		padding-left: 0.25rem;
	}

	article > aside {
		background: var(--card-bg);
		padding: 1rem;
		font-size: 0.875rem;
		text-align: justify;
	}

	article {
		h1,
		h2,
		h3,
		h4,
		h5,
		h6 {
			letter-spacing: -3%;
		}
	}

	li > p:only-child {
		margin-block: 0;
	}

	/* Search form component */
	form.search {
		display: flex;
		gap: 1rem;
		margin: 1rem 0 2rem;
	}

	form.search input {
		flex-grow: 1;
		padding: 0.5rem;
		border: 1px solid var(--border-dim);
		border-radius: 4px;
		font-size: 1rem;
		line-height: 1.3;
		background: transparent;
		color: var(--text-color);
		outline: none;
	}

	form.search button {
		background-color: var(--border-dim);
		color: var(--text-color);
		border: none;
		padding: 0.5rem 1rem;
		border-radius: 4px;
		font-size: 1rem;
		line-height: 1.3;
	}

	/* Responsive adjustments for components */
	@media (max-width: 500px) {
		article ol > li {
			max-width: 100%;
		}

		blockquote {
			margin-left: -1.5rem;
		}
	}
}

@layer layout {
	/* Layout system variables */
	:root {
		--width: 66ch;
		--grid-header-width: 30rem;
		--grid-header-padding: 5rem;
		--grid-columns: [header] minmax(16rem, 40rem) [main] minmax(66ch, 1fr);
	}

	/* Main grid layout */
	section {
		display: grid;
		grid-template-columns: var(--grid-columns);

		&:last-of-type {
			border-bottom: 1px solid var(--border-dim);
		}
	}

	section > header {
		width: var(--grid-header-width);
		justify-self: end;
		border-right: 1px solid var(--border-dim);
		padding: var(--grid-header-padding);
		transition:
			width,
			border,
			padding-top 0.2s ease-in-out;
		transition-behavior: allow-discrete;

		& h1,
		h2 {
			font-size: 1rem;
			margin: 1rem 0 0;
		}

		& p {
			margin: 0;
			font-size: 0.825rem;
			font-family: var(--font-family-heading);
		}
	}

	section > div,
	section > article {
		padding: 5rem;
		width: 100%;
		& p,
		ul,
		form,
		figure {
			max-width: var(--width);
		}
	}

	/* Layout responsive breakpoints */
	@media screen and (min-width: 1536px) {
		:root {
			--grid-columns: [header] 1fr [main] 1fr;
		}
	}

	@media screen and (max-width: 1440px) {
		pre {
			max-width: 100%;
		}
	}

	@media screen and (max-width: 1168px) {
		:root {
			--grid-header-width: calc(100% - 4rem);
			--grid-header-padding: 5rem 2rem;
		}
	}

	@media screen and (max-width: 796px) {
		:root {
			--grid-columns: [main] 1fr;
			--grid-header-padding: 1.5rem;
			--grid-header-width: 100%;
		}

		/* section {
			border-left: 1px solid var(--border-dim);
			margin-left: 1rem;
		} */

		section > header {
			border-right: none;
			border-color: transparent;
			justify-self: start;
		}

		section > div,
		section > article {
			padding: 0 1.5rem 2rem;
			box-sizing: border-box;
			max-width: 100vw;
		}
	}
}

@layer utilities {
	/* Typography utilities */
	.text-sm {
		font-size: 0.875rem;
	}
	.text-xs {
		font-size: 0.75rem;
	}
	.text-dim {
		color: var(--text-dim);
	}
	.text-very-dim {
		color: var(--text-very-dim);
	}
	.font-mono {
		font-family: var(--font-family-mono);
	}

	/* Layout utilities */
	.flex {
		display: flex;
	}
	.flex-col {
		flex-direction: column;
	}
	.flex-wrap {
		flex-wrap: wrap;
	}
	.items-center {
		align-items: center;
	}

	/* Spacing utilities */
	.gap-1 {
		gap: 0.5rem;
	}
	.gap-2 {
		gap: 1rem;
	}
	.pt-2 {
		padding-top: 0.5rem;
	}
	.pt-4 {
		padding-top: 1rem;
	}
	.pt-8 {
		padding-top: 2rem;
	}
	.pb-4 {
		padding-bottom: 1rem;
	}

	/* Sizing utilities */
	.w-prose {
		max-width: var(--width);
		margin: auto;
	}
	.w-full {
		width: 100%;
	}

	/* Position utilities */
	.sticky {
		position: sticky;
	}
	.top-1 {
		top: 0.5rem;
	}

	/* Display utilities */
	.hidden {
		display: none;
	}
	.contents {
		display: contents;
	}
}
