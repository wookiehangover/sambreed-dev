---
import type { CollectionEntry } from "astro:content";
import type { WikiCategory } from "~/types/wiki";
import CategoryList from "./CategoryList.astro";
import Icon, { type IconName } from "~/components/Icon.astro";

export interface Props {
	entries: CollectionEntry<"wiki">[];
	map: Map<string, WikiCategory>;
	icon: IconName;
	title: string;
	description: string;
}

const { entries, map, icon, title, description } = Astro.props;
---

<section>
	<header>
		<div>
			<h2 class="flex gap-1 items-center">
				<Icon name={icon} />
				<span>{title}</span>
			</h2>
			<p class="pt-2">{description}</p>
		</div>
	</header>
	<div>
		<ul>
			{
				entries.map((entry) => (
					<li>
						<h2>
							<a href={`/wiki/${entry.id}`}>{entry.data.title}</a>
						</h2>
						<p class="text-sm">{entry.data.description}</p>
						<nav class="text-xs flex gap-1 w-full">
							<CategoryList categories={entry.data.categories} map={map} />
						</nav>
					</li>
				))
			}
		</ul>
	</div>
</section>

<style>
	header > div {
		position: sticky;
		top: 1rem;
	}

	ul {
		display: grid;
		list-style: none;
		grid-template-columns: 1fr 1fr;
		gap: 1rem;
		margin: 0;
		padding: 0;
	}

	li {
		border: 1px solid transparent;
		border-radius: 4px;
		padding: 0 1rem;
		display: flex;
		flex-direction: column;
		transition: background 0.2s ease-in-out;
		background: var(--card-bg);

		&:hover {
			background: var(--card-bg-hover);
		}
	}

	h2 {
		font-family: var(--font-family-body);
		font-size: 1rem;
		line-height: 1.3;
		font-weight: normal;
		text-wrap: wrap;
	}

	nav {
		border-top: 1px solid var(--border-dim);
		padding: 0.5rem 0;
		margin-top: auto;
		flex-wrap: wrap;
		height: 40px;
		overflow: hidden;
	}

	@media (max-width: 512px) {
		ul {
			grid-template-columns: 1fr;
		}
		nav {
			height: auto;
			overflow: auto;
		}
	}
</style>
