---
import { getCollection } from "astro:content"
import getAllCategories from "../../../utils/get-all-categories";
import WikiEntryLayout from "../../../layouts/WikiEntry.astro";
import kebabCase from "just-kebab-case"
import WikiCardList from "../../../components/WikiCardList.astro";
const { id } = Astro.params;

if (id === undefined) {
  throw new Error("Slug is required");
}

const entries = await getCollection("wiki", ({ data }) => {
  return data.categories.find((category) => kebabCase(category) === id)
})

const { map } = getAllCategories(entries)
const title = map.get(id)?.label ?? id
---

<WikiEntryLayout content={{ title }} size="full">
  <WikiCardList entries={entries} map={map} />
</WikiEntryLayout>
